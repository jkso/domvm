// https://github.com/leeoniya/domvm (3.x-dev, server build)
!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):n.domvm=e()}(this,function(){"use strict";var A=1,f=2,C=3,E=4,R=5,n="undefined"!=typeof window,e=n?window:{},a=n?document:{},o=e.requestAnimationFrame,O={};function I(){}var y=Array.isArray;function i(n){return null!=n&&n.constructor===Object}function u(n){return"function"==typeof n}function d(n){for(var e=arguments,t=1;t<e.length;t++)for(var r in e[t])n[r]=e[t][r];return n}function s(n,e){for(var t=[],r=e;r<n.length;r++)t.push(n[r]);return t}function p(n,e){for(var t in n)if(n[t]!==e[t])return!1;return!0}function h(n,e){var t=n.length;if(e.length!==t)return!1;for(var r=0;r<t;r++)if(n[r]!==e[r])return!1;return!0}function r(n){if(!o)return n;var e,t,r;function l(){e=0,n.apply(t,r)}return function(){t=this,r=arguments,e||(e=o(l))}}function m(n){return"o"===n[0]&&"n"===n[1]}function b(n){return"_"===n[0]}function c(n){n&&n.el&&n.el.offsetHeight}function L(n){return null!=n.node&&null!=n.node.el}function g(n,e){switch(e){case"value":case"checked":case"selected":return!0}return!1}function k(n){for(n=n||O;null==n.vm&&n.parent;)n=n.parent;return n.vm}function v(){}var t=v.prototype={constructor:v,type:null,vm:null,key:null,ref:null,data:null,hooks:null,ns:null,el:null,tag:null,attrs:null,body:null,flags:0,_class:null,_diff:null,_dead:!1,_lis:!1,idx:null,parent:null};function _(n){var e=new v;return e.type=f,e.body=n,e}var w=function(){return!1},l=I,x=I,N=I;function S(n,e){var t=x(n,function(n){t&&(null!=e.node&&e.redraw(),N(t))});return l(n)}function M(n,e){var t=x(n,function(n){t&&null!=e.node&&e.redraw()});return t}var T={},V=/\[(\w+)(?:=(\w+))?\]/g;var j=1,D=2,z=4,U=8;function F(n,e,t,r){var l=new v;l.type=A,l.flags=r||0,l.attrs=e||null;var o=function(n){var e,t,r,l,o=T[n];if(null==o)for(T[n]=o={tag:(e=n.match(/^[-\w]+/))?e[0]:"div",id:(t=n.match(/#([-\w]+)/))?t[1]:null,class:(r=n.match(/\.([-\w.]+)/))?r[1].replace(/\./g," "):null,attrs:null};l=V.exec(n);)null==o.attrs&&(o.attrs={}),o.attrs[l[1]]=l[2]||"";return o}(n);l.tag=o.tag;var a=null!=o.id,i=null!=o.class,u=null!=o.attrs;if(a||i||u){var f=l.attrs||{};if(a&&null==f.id&&(f.id=o.id),i&&(l._class=o.class,f.class=o.class+(null!=f.class?" "+f.class:"")),u)for(var d in o.attrs)null==f[d]&&(f[d]=o.attrs[d]);l.attrs=f}var s=l.attrs;return null!=s&&(null!=s._key&&(l.key=s._key),null!=s._ref&&(l.ref=s._ref),null!=s._hooks&&(l.hooks=s._hooks),null!=s._data&&(l.data=s._data),null!=s._flags&&(l.flags=s._flags),null==l.key&&(null!=l.ref?l.key=l.ref:null!=s.id?l.key=s.id:null!=s.name&&(l.key=s.name+("radio"===s.type||"checkbox"===s.type?s.value:"")))),null!=t&&(l.body=t),l}function H(n,e,t,r){if(n.type!==R&&n.type!==E){var l,o,a;n.parent=e,n.idx=t,n.vm=r,null!=n.ref&&(l=k(n),o=n.ref,a=n,function(n,e,t){for(var r;r=e.shift();)0===e.length?n[r]=t:n[r]=n=n[r]||{}}(l,("refs."+o).split("."),a));var i=n.hooks,u=r&&r.hooks;(i&&(i.willRemove||i.didRemove)||u&&(u.willUnmount||u.didUnmount))&&function(n){for(;n=n.parent;)n.flags|=j}(n),y(n.body)?function(n){for(var e=n.body,t=0;t<e.length;t++){var r=e[t];!1===r||null==r?e.splice(t--,1):y(r)?(o=r,a=t--,i=1,(l=e).splice.apply(l,[a,i].concat(o))):(null==r.type&&(e[t]=r=_(""+r)),r.type===f?null==r.body||""===r.body?e.splice(t--,1):0<t&&e[t-1].type===f?(e[t-1].body+=r.body,e.splice(t--,1)):H(r,n,t,null):H(r,n,t,null))}var l,o,a,i}(n):""===n.body?n.body=null:w(n.body)&&(n.body=S(n.body,k(n)))}}var G={animationIterationCount:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridColumn:!0,order:!0,lineClamp:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0};function P(n,e){return isNaN(e)||G[n]?e:e+"px"}function W(n,e){var t,r=(n.attrs||O).style,l=e?(e.attrs||O).style:null;if(null==r||("string"===(t=typeof r)||"number"===t))n.el.style.cssText=r;else{for(var o in r){var a=r[o];w(a)&&(r[o]=a=S(a,k(n))),(null==l||null!=a&&a!==l[o])&&(n.el.style[o]=P(o,a))}if(l)for(var i in l)null==r[i]&&(n.el.style[i]="")}}var Y=[];function q(n,e,t,r,l){if(null!=n){var o=t.hooks[e];if(o){if("d"!==e[0]||"i"!==e[1]||"d"!==e[2])return o(t,r);l?c(t.parent)&&o(t,r):Y.push([o,t,r])}}}function B(n){var e;if(Y.length)for(c(n.node);e=Y.shift();)e[0](e[1],e[2])}function Z(n){return n.nextSibling}function $(n,e,t){var r=e._node,l=r.vm;if(y(r.body))if((r.flags&j)===j)for(var o=0;o<r.body.length;o++)$(e,r.body[o].el);else X(r);delete e._node,n.removeChild(e),q(r.hooks,"didRemove",r,null,t),null!=l&&(q(l.hooks,"didUnmount",l,l.data,t),l.node=null)}function K(n,e){var t=e._node;if(!t._dead){var r,l,o,a,i=function n(e){var t=e.vm,r=null!=t&&q(t.hooks,"willUnmount",t,t.data),l=q(e.hooks,"willRemove",e);if((e.flags&j)===j&&y(e.body))for(var o=0;o<e.body.length;o++)n(e.body[o]);return r||l}(t);null!=i&&("object"==typeof(a=i)&&u(a.then))?(t._dead=!0,i.then((r=$,l=[n,e,!0],function(){return r.apply(o,l)}))):$(n,e)}}function X(n){for(var e=n.body,t=0;t<e.length;t++){var r=e[t];delete r.el._node,null!=r.vm&&(r.vm.node=null),y(r.body)&&X(r)}}function J(n){var e=n.el;if(0==(n.flags&j))y(n.body)&&X(n),e.textContent=null;else{var t=e.firstChild;do{var r=Z(t);K(e,t)}while(t=r)}}function Q(n,e,t){var r=e._node,l=null!=e.parentNode,o=e!==t&&l?null:r.vm;null!=o&&q(o.hooks,"willMount",o,o.data),q(r.hooks,l?"willReinsert":"willInsert",r),n.insertBefore(e,t),q(r.hooks,l?"didReinsert":"didInsert",r),null!=o&&q(o.hooks,"didMount",o,o.data)}function nn(n,e,t){Q(n,e,t?Z(t):null)}var en={};var tn=I,rn=!1;function ln(n,e,t){n[e]=t}function on(n,e,t,r,l){var o=n.apply(l,e.concat([t,r,l,l.data]));l.onevent(t,r,l,l.data,e),tn.call(null,t,r,l,l.data,e),!1===o&&(t.preventDefault(),t.stopPropagation())}function an(n){var e,t,r=function(n){for(;null==n._node;)n=n.parentNode;return n._node}(n.target),l=k(r),o=n.currentTarget._node.attrs["on"+n.type];if(y(o))on(e=o[0],t=o.slice(1),n,r,l);else for(var a in o)if(n.target.matches(a)){var i=o[a];y(i)?(e=i[0],t=i.slice(1)):(e=i,t=[]),on(e,t,n,r,l)}}function un(n,e,t,r){if(t!==r){var l=n.el;null==t||u(t)?ln(l,e,t):null==r&&ln(l,e,an)}}function fn(n,e,t){var r,l,o,a,i,u,f,d,s=n.attrs||O,c=e.attrs||O;if(s===c);else{for(var v in s){var y=s[v];if(null!=y){var p=g(n.tag,v),h=p?n.el[v]:c[v];w(y)&&(s[v]=y=S(y,k(n))),y===h||("style"===v?W(n,e):b(v)||(m(v)?un(n,v,y,h):(i=v,u=y,f=p,d=void 0,d=(a=n).el,null!=a.ns?d.setAttribute(i,u):"class"===i?d.className=u:"id"===i||"boolean"==typeof u||f?d[i]=u:"."===i[0]?d[i.substr(1)]=u:d.setAttribute(i,u))))}}for(var v in c)null==s[v]&&!b(v)&&(l=v,o=g((r=n).tag,v)||m(v),"."===l[0]&&(l=l.substr(1),o=!0),o?r.el[l]="":r.el.removeAttribute(l))}}function dn(n,e,t,r){return n.type===E&&(e=n.data,t=n.key,r=n.opts,n=n.view),new Nn(n,e,t,r)}function sn(n){for(var e=0;e<n.body.length;e++){var t=n.body[e],r=t.type;if(r<=C)Q(n.el,cn(t));else if(r===E){r=(l=dn(t.view,t.data,t.key,t.opts)._redraw(n,e,!1)).node.type,Q(n.el,cn(l.node))}else if(r===R){var l;(l=t.vm)._redraw(n,e),r=l.node.type,Q(n.el,l.node.el)}}}function cn(n,e){var t,r,l,o;return null==n.el&&(n.type===A?(n.el=e||(l=n.tag,null!=(o=n.ns)?a.createElementNS(o,l):a.createElement(l)),null!=n.attrs&&fn(n,O),(n.flags&U)===U&&n.body.body(n),y(n.body)?sn(n):null!=n.body&&(n.el.textContent=n.body)):n.type===f?n.el=e||(r=n.body,a.createTextNode(r)):n.type===C&&(n.el=e||(t=n.body,a.createComment(t)))),(n.el._node=n).el}var vn=1,yn=2;function pn(u,f,d,s,c,v,y,p){return function(n,e,t,r,l,o){var a,i;if(null!=r[s]){if(null==(a=r[s]._node))return void(r[s]=u(r[s]));if(a.parent!==n)return i=u(r[s]),null!=a.vm?a.vm.unmount(!0):K(e,r[s]),void(r[s]=i)}if(r[c]==l)return yn;if(null==r[c].el)d(e,cn(r[c]),r[s]),r[c]=f(r[c],t);else if(r[c].el===r[s])r[c]=f(r[c],t),r[s]=u(r[s]);else{if(o||a!==r[y])return o&&null!=r[s]?function(n,e,t,r,l,o,a,i,u){if(i._lis)t(o,u[l].el,u[r]),u[l]=e(u[l],a);else{var f=function(n,e){var t,r=0,l=e.length-1;if(l<=2147483647)for(;r<=l;){if(e[t=r+l>>1]===n)return t;e[t]<n?r=t+1:l=t-1}else for(;r<=l;){if(e[t=Math.floor((r+l)/2)]===n)return t;e[t]<n?r=t+1:l=t-1}return r==e.length?null:r}(i.idx,u.tombs);i._lis=!0;var d=n(u[r]);t(o,u[r],null!=f?a[u.tombs[f]].el:f),null==f?u.tombs.push(i.idx):u.tombs.splice(f,0,i.idx),u[r]=d}}(u,f,d,s,c,e,t,a,r):vn;i=r[s],r[s]=u(i),p(e,i,r[v]),r[v]=i}}}var hn=pn(Z,function(n,e){return e[n.idx+1]},Q,"lftSib","lftNode","rgtSib","rgtNode",nn),mn=pn(function(n){return n.previousSibling},function(n,e){return e[n.idx-1]},nn,"rgtSib","rgtNode","lftSib","lftNode",Q);function bn(n,e,t,r){for(var l=[],o=l.slice.call(e.childNodes),a=0;a<o.length;a++){var i=o[a]._node;i.parent===n&&l.push(i.idx)}for(var u=function(n){var e,t,r=n.slice(),l=[];l.push(0);for(var o=0,a=n.length;o<a;++o){var i=l[l.length-1];if(n[i]<n[o])r[o]=i,l.push(o);else{for(e=0,t=l.length-1;e<t;){var u=(e+t)/2|0;n[l[u]]<n[o]?e=u+1:t=u}n[o]<n[l[e]]&&(0<e&&(r[o]=l[e-1]),l[e]=o)}}for(t=l[(e=l.length)-1];0<e--;)t=r[l[e]=t];return l}(l).map(function(n){return l[n]}),f=0;f<u.length;f++)t[u[f]]._lis=!0;for(r.tombs=u;;){if(hn(n,e,t,r,null,!0)===yn)break}}function gn(n){return n.el._node.parent!==n.parent}function kn(n,e,t){return e[t]}function _n(n,e,t){for(;t<e.length;t++){var r=e[t];if(null!=r.vm){if(n.type===E&&r.vm.view===n.view&&r.vm.key===n.key||n.type===R&&r.vm===n.vm)return r}else if(!gn(r)&&n.tag===r.tag&&n.type===r.type&&n.key===r.key&&(n.flags&~j)==(r.flags&~j))return r}return null}function wn(n,e,t){if(null==e._keys){if(e[t].key===n.key)return e[t];for(var r={},l=0;l<e.length;l++)r[e[l].key]=l;e._keys=r}return e[e._keys[n.key]]}function xn(n,e){q(e.hooks,"willRecycle",e,n);var t=n.el=e.el,r=e.body,l=n.body;if((t._node=n).type!==f||l===r){null==n.attrs&&null==e.attrs||fn(n,e);var o=y(r),a=y(l),i=(n.flags&U)===U;o?a||i?function(n,e){var t=n.body,r=t.length,l=e.body,o=l.length,a=(n.flags&U)===U,i=(n.flags&D)===D,u=(n.flags&z)===z,f=!i&&n.type===A,d=!0,s=0===o?I:u?wn:i||a?kn:_n;if(f&&0===r)return J(e),a&&(n.body=[]);var c,v,y=0,p=!1,h=0;if(a)var m={key:null},b=Array(r);for(var g=0;g<r;g++){if(a){var k=!1,_=null;d&&(u&&(m.key=t.key(g)),c=s(m,l,h)),null!=c?(v=c.idx,!0===(_=t.diff(g,c))?((w=c).parent=n,w.idx=g,w._lis=!1):k=!0):k=!0,k&&(H(w=t.tpl(g),n,g),w._diff=null!=_?_:t.diff(g),null!=c&&xn(w,c)),b[g]=w}else{var w=t[g],x=w.type;if(x<=C)(c=d&&s(w,l,h))&&(xn(w,c),v=c.idx);else if(x===E){if(c=d&&s(w,l,h)){v=c.idx;var N=c.vm._update(w.data,n,g)}else var N=dn(w.view,w.data,w.key,w.opts)._redraw(n,g,!1);x=N.node.type}else if(x===R){var S=L(w.vm),N=w.vm._update(w.data,n,g,S);x=N.node.type}}if(null!=c&&(v===h?++h===o&&o<r&&(c=null,d=!1):p=!0,!u&&100<o&&p&&++y%10==0))for(;h<o&&gn(l[h]);)h++}a&&(n.body=b);f&&function(n,e){var t=e.body,r=n.el,l=n.body,o={lftNode:l[0],rgtNode:l[l.length-1],lftSib:(t[0]||O).el,rgtSib:(t[t.length-1]||O).el};n:for(;;){for(;;){var a=hn(n,r,l,o,null,!1);if(a===vn)break;if(a===yn)break n}for(;;){var i=mn(n,r,l,o,o.lftNode,!1);if(i===vn)break;if(i===yn)break n}bn(n,r,l,o);break}}(n,e)}(n,e):l!==r&&(null!=l?t.textContent=l:J(e)):a?(J(e),sn(n)):l!==r&&(null!=l&&null!=r?t.firstChild.nodeValue=l:t.textContent=l),q(e.hooks,"didRecycle",e,n)}else t.nodeValue=l}function Nn(n,e,t,r){var l=this;l.view=n,l.data=e,l.key=t,w(e)&&(l._stream=M(e,l)),r&&(l.opts=r,l.config(r));var o=i(n)?n:n.call(l,l,e,t,r);u(o)?l.render=o:(l.render=o.render,l.config(o)),l.init&&l.init.call(l,l,l.data,l.key,r)}var Sn=Nn.prototype={constructor:Nn,_diff:null,init:null,view:null,key:null,data:null,state:null,api:null,opts:null,node:null,hooks:null,onevent:I,refs:null,render:null,mount:function(n,e){var t=this;e?(J({el:n,flags:0}),t._redraw(null,null,!1),n.nodeName.toLowerCase()!==t.node.tag?(cn(t.node),Q(n.parentNode,t.node.el,n),n.parentNode.removeChild(n)):Q(n.parentNode,cn(t.node,n),n)):(t._redraw(null,null),n&&Q(n,t.node.el));n&&B(t);return t},unmount:function(n){w(this._stream)&&N(this._stream);var e=this.node;K(e.el.parentNode,e.el),n||B(this)},config:function(n){var e=this;n.init&&(e.init=n.init),n.diff&&(e.diff=n.diff),n.onevent&&(e.onevent=n.onevent),n.hooks&&(e.hooks=d(e.hooks||{},n.hooks)),n.onemit&&(e.onemit=d(e.onemit||{},n.onemit))},parent:function(){return k(this.node.parent)},root:function(){for(var n=this.node;n.parent;)n=n.parent;return n.vm},redraw:function(n){null==n&&(n=rn);var e=this;return n?e._redraw(null,null,L(e)):(e._redrawAsync=e._redrawAsync||r(function(n){return e.redraw(!0)}))(),e},update:function(n,e){null==e&&(e=rn);var t=this;return e?t._update(n,null,null,L(t)):(t._updateAsync=t._updateAsync||r(function(n){return t.update(n,!0)}))(n),t},_update:function(n,e,t,r){var l=this;null!=n&&l.data!==n&&(q(l.hooks,"willUpdate",l,n),l.data=n,w(l._stream)&&N(l._stream),w(n)&&(l._stream=M(n,l)));return l._redraw(e,t,r)},_redraw:function(n,e,t){var r,l,o=null==n,a=this,i=a.node&&a.node.el&&a.node.el.parentNode,u=a.node;if(null!=a.diff&&(r=a._diff,a._diff=l=a.diff(a,a.data),null!=u)){var f=y(r)?h:p,d=r===l||f(r,l);if(d)return An(a,u,n,e)}i&&q(a.hooks,"willRedraw",a,a.data);var s=a.render.call(a,a,a.data,r,l);if(s===u)return An(a,u,n,e);(a.refs=null)!=a.key&&s.key!==a.key&&(s.key=a.key);a.node=s,n?(H(s,n,e,a),n.body[e]=s):u&&u.parent?(H(s,u.parent,u.idx,a),u.parent.body[u.idx]=s):H(s,null,null,a);if(!1!==t)if(u)if(u.tag!==s.tag||u.key!==s.key){u.vm=s.vm=null;var c=u.el.parentNode,v=Z(u.el);K(c,u.el),Q(c,cn(s),v),u.el=s.el,s.vm=a}else xn(s,u);else cn(s);i&&q(a.hooks,"didRedraw",a,a.data),o&&i&&B(a);return a},_redrawAsync:null,_updateAsync:null};function An(n,e,t,r){return null!=t&&((t.body[r]=e).idx=r,e.parent=t,e._lis=!1),n}function Cn(n,e,t,r){var l,o;return null==t?i(e)?l=e:o=e:(l=e,o=t),F(n,l,o,r)}var En="http://www.w3.org/2000/svg";function Rn(n,e,t,r){this.view=n,this.data=e,this.key=t,this.opts=r}function On(n){this.vm=n}Rn.prototype={constructor:Rn,type:E,view:null,data:null,key:null,opts:null},On.prototype={constructor:On,type:R,vm:null};var In={config:function(n){var e,t;tn=n.onevent||tn,null!=n.syncRedraw&&(rn=n.syncRedraw),n.onemit&&(e=n.onemit,d(en,e)),n.stream&&(t=n.stream,w=t.is,l=t.val,x=t.sub,N=t.unsub)},ViewModel:Nn,VNode:v,createView:dn,defineElement:Cn,defineSvgElement:function(n,e,t,r){var l=Cn(n,e,t,r);return l.ns=En,l},defineText:_,defineComment:function(n){var e=new v;return e.type=C,e.body=n,e},defineView:function(n,e,t,r){return new Rn(n,e,t,r)},injectView:function(n){return new On(n)},injectElement:function(n){var e=new v;return e.type=A,e.el=e.key=n,e},lazyList:function(l,o){var a=l.length,i={items:l,length:a,key:function(n){return o.key(l[n],n)},diff:function(n,e){var t=o.diff(l[n],n);if(null==e)return t;var r=e._diff;return(t===r||y(r)?h(t,r):p(t,r))||t},tpl:function(n){return o.tpl(l[n],n)},map:function(n){return o.tpl=n,i},body:function(n){for(var e=Array(a),t=0;t<a;t++){var r=i.tpl(t);r._diff=i.diff(t),H(e[t]=r,n,t)}n.body=e}};return i},FIXED_BODY:D,DEEP_REMOVE:j,KEYED_LIST:z,LAZY_LIST:U};function Ln(n){var e,t,r=arguments,l=r.length;if(1<l){var o=1;i(r[1])&&(t=r[1],o=2),e=l!==o+1||r[o]instanceof v||r[o]instanceof Rn||r[o]instanceof On?s(r,o):r[o]}return F(n,t,e)}function Mn(n){var e="";for(var t in n)null!=n[t]&&(e+=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()+": "+P(t,n[t])+"; ");return e}function Tn(n){return null==n?"":""+n}t.patch=function(n,e){!function(n,e,t){if(null!=e.type){if(null!=n.vm)return;H(e,n.parent,n.idx,null),xn(n.parent.body[n.idx]=e,n),t&&c(e),B(k(e))}else{var r=Object.create(n);r.attrs=d({},n.attrs);var l=d(n.attrs,e);if(null!=n._class){var o=l.class;l.class=null!=o&&""!==o?n._class+" "+o:n._class}fn(n,r),t&&c(n)}}(this,n,e)},Sn.emit=function(n){var e=this,t=e,r=s(arguments,1).concat(t,t.data);do{var l=e.onemit,o=l?l[n]:null;if(o){o.apply(e,r);break}}while(e=e.parent());en[n]&&en[n].apply(e,r)},Sn.onemit=null,Sn.body=function(){return function n(e,t){var r=e.body;if(y(r))for(var l=0;l<r.length;l++){var o=r[l];null!=o.vm?t.push(o.vm):n(o,t)}return t}(this.node,[])},In.defineElementSpread=Ln,In.defineSvgElementSpread=function(){var n=Ln.apply(null,arguments);return n.ns=En,n},Sn._stream=null;var Vn={area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0};function jn(n){n=Tn(n);for(var e=0,t="";e<n.length;e++)switch(n[e]){case"&":t+="&amp;";break;case"<":t+="&lt;";break;case">":t+="&gt;";break;default:t+=n[e]}return t}function Dn(n){n=Tn(n);for(var e=0,t="";e<n.length;e++)t+='"'===n[e]?"&quot;":n[e];return t}function zn(n,e){for(var t="",r=0;r<n.length;r++)t+=Fn(n[r],e);return t}var Un=".innerHTML";function Fn(n,e){var t,r;switch(n.type){case E:t=dn(n.view,n.data,n.key,n.opts).html(e);break;case R:t=n.vm.html();break;case A:if(null!=n.el&&null==n.tag){t=n.el.outerHTML;break}var l="";l+="<"+n.tag;var o=n.attrs,a=null!=o;if(a){for(var i in o)if(!(m(i)||"."===i[0]||"_"===i[0]||!1===e&&g(n.tag,i))){var u=o[i];"style"!==i||null==u?!0===u?l+=" "+jn(i)+'=""':!1===u||null!=u&&(l+=" "+jn(i)+'="'+Dn(u)+'"'):r="object"==typeof u?Mn(u):u}null!=r&&(l+=' style="'+Dn(r.trim())+'"')}if(null==n.body&&null!=n.ns&&"svg"!==n.tag)return l+"/>";l+=">",Vn[n.tag]||(a&&null!=o[Un]?l+=o[Un]:y(n.body)?l+=zn(n.body,e):(n.flags&U)===U?(n.body.body(n),l+=zn(n.body,e)):l+=jn(n.body),l+="</"+n.tag+">"),t=l;break;case f:t=jn(n.body);break;case C:t="\x3c!--"+jn(n.body)+"--\x3e"}return t}return Sn.html=function(n){return null==this.node&&this._redraw(null,null,!1),Fn(this.node,n)},t.html=function(n){return Fn(this,n)},In});